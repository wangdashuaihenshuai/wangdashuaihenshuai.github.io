{"version":3,"sources":["webpack:///./src/index.css?68b8","webpack:///./src/App.css?2a68","lib/gpuRun.ts","page/light/GPUCircle.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["gpu","GPU","GPURunner","N","width","hight","max_distance","circleInfos","calculate","newCalculate","createKernel","length","a","constants","TWO_PI","thread","z","Math","random","cosA","cos","sinA","sin","x","y","dx","dy","st","sqrt","distance","lightIndex","MIN_STEP_LEN","i","MAX_STEP","ox","oy","index","ddx","ddy","dt","PI","output","window","innerWidth","innerHeight","circleInfosToGPUCircle","infos","ret","info","push","r","light","g","b","render","circles","lightInfos","color","setOutput","setGraphical","canvas","addCircleInfos","GPUCircle","useState","setN","console","log","useEffect","dom","document","getElementById","appendChild","runner","gpuCircle","setCircles","lightInfo","run","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM"],"mappings":"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","file":"static/js/main.0793e0bb.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","import { GPU } from 'gpu.js'\nconst gpu = new GPU();\n\nexport default class GPURunner {\n\tN: number\n\twidth: number\n\thight: number\n\tmax_distance: number\n\tcircleInfos: number[][][]\n\tcalculate: any\n\tconstructor(N: number, width: number, hight: number) {\n\t\tthis.N = N\n\t\tthis.width = width\n\t\tthis.hight = hight\n\t\tthis.max_distance = hight > width ? hight : width;\n\t\tthis.circleInfos = []\n\t\tthis.calculate = this.newCalculate()\n\t}\n\n\tnewCalculate() {\n\t\treturn gpu.createKernel(function (circleInfos: number[][][], length: number) {\n\t\t\t/* @ts-ignore */\n\t\t\tconst a = this.constants.TWO_PI * (this.thread.z / 1.00 + Math.random()) / this.constants.N\n\t\t\tconst cosA = Math.cos(a)\n\t\t\tconst sinA = Math.sin(a)\n\t\t\tconst x = this.thread.x\n\t\t\tconst y = this.thread.y\n\t\t\t// \t/* @ts-ignore */\n\n\t\t\tlet dx = x - circleInfos[0][0][0]\n\t\t\tlet dy = y - circleInfos[0][0][1]\n\t\t\tlet st = Math.sqrt(dx * dx + dy * dy) - circleInfos[0][0][2]\n\n\t\t\tlet distance = 0\n\t\t\tlet lightIndex = -1\n\t\t\tif (st < this.constants.MIN_STEP_LEN) {\n\t\t\t\treturn 0\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < this.constants.MAX_STEP && distance < this.constants.max_distance; i++) {\n\t\t\t\t// \t/* @ts-ignore */\n\t\t\t\tlet ox = x + distance * cosA\n\t\t\t\tlet oy = y + distance * sinA\n\n\t\t\t\tfor (let index = 0; index < length; index++) {\n\t\t\t\t\tlet ddx = ox - circleInfos[index][0][0]\n\t\t\t\t\tlet ddy = oy - circleInfos[index][0][1]\n\t\t\t\t\tconst dt = Math.sqrt(ddx * ddx + ddy * ddy) - circleInfos[index][0][2]\n\t\t\t\t\tif (dt < st) {\n\t\t\t\t\t\tst = dt\n\t\t\t\t\t\tlightIndex = index\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* @ts-ignore */\n\t\t\t\tif (st < this.constants.MIN_STEP_LEN) {\n\t\t\t\t\treturn lightIndex\n\t\t\t\t}\n\n\t\t\t\tdistance = distance + st\n\t\t\t}\n\n\t\t\treturn -1\n\t\t}, {\n\t\t\tconstants: {\n\t\t\t\tN: this.N,\n\t\t\t\tmax_distance: this.max_distance,\n\t\t\t\tPI: Math.PI,\n\t\t\t\tTWO_PI: 2 * Math.PI,\n\t\t\t\tMIN_STEP_LEN: 0.1,\n\t\t\t\tMAX_STEP: 50\n\t\t\t},\n\t\t\toutput: [this.hight, this.width, this.N],\n\t\t})\n\t}\n\n\tinit(N: number, width: number, hight: number) {\n\t\tthis.N = N\n\t\tthis.width = width\n\t\tthis.hight = hight\n\t\tthis.max_distance = hight > width ? hight : width;\n\t}\n\n\n\tsetCircles(circleInfos: number[][][]) {\n\t\tthis.circleInfos = circleInfos\n\t}\n\n\trun(): number[][][] {\n\t\treturn this.calculate(this.circleInfos, this.circleInfos.length)\n\t}\n}","import { GPU } from 'gpu.js';\nimport { useEffect, useState } from 'react';\nimport GPURunner from '../../lib/gpuRun';\nconst width = window.innerWidth\nconst hight = window.innerHeight\n\nconst gpu = new GPU();\n\nfunction circleInfosToGPUCircle(infos: Circle[]): number[][][] {\n\tconst ret = []\n\tfor (const info of infos) {\n\t\tret.push(\n\t\t\t[\n\t\t\t\t[info.x, info.y, info.r],\n\t\t\t\t[info.light.r, info.light.g, info.light.b]\n\t\t\t]\n\t\t)\n\t}\n\n\treturn ret\n}\n\n/* @ts-ignore */\nconst render = gpu.createKernel(function (circles: number[][][], lightInfos: number[][][], N: number) {\n\t/* @ts-ignore */\n\tlet r = 0\n\tlet g = 0\n\tlet b = 0\n\tfor (let index = 0; index < N; index++) {\n\t\tconst lightIndex = lightInfos[index][this.thread.x][this.thread.y]\n\t\tif (lightIndex >= 0) {\n\t\t\tr = r + circles[lightIndex][1][0]\n\t\t\tg = g + circles[lightIndex][1][1]\n\t\t\tb = b + circles[lightIndex][1][2]\n\t\t}\n\t}\n\tthis.color(r / N, g / N, b / N, 1);\n}).setOutput([width, hight])\n\t.setGraphical(true);\n\nconst canvas = render.canvas;\n\nconst circleInfos: Circle[] = []\n\nfunction addCircleInfos(info: Circle) {\n\tcircleInfos.push({\n\t\tx: info.x * hight,\n\t\ty: info.y * width,\n\t\tr: info.r * hight,\n\t\tlight: info.light\n\t})\n}\n\naddCircleInfos({\n\tx: 0.5,\n\ty: 0.5,\n\tr: 0.1,\n\tlight: { r: 2, g: 0, b: 2 },\n})\n\naddCircleInfos({\n\tx: 0.3,\n\ty: 0.3,\n\tr: 0.1,\n\tlight: { r: 0, g: 2, b: 0 },\n})\n\nexport default function GPUCircle() {\n\tconst [N, setN] = useState<number>(32)\n\tconsole.log(setN)\n\n\t// function Run() {\n\t// \trender();\n\t// \twindow.requestAnimationFrame(Run)\n\t// }\n\n\tuseEffect(() => {\n\t\tconst dom = window.document.getElementById('GPUCircle')\n\t\tif (dom) {\n\t\t\tdom.appendChild(canvas)!;\n\t\t\tconst runner = new GPURunner(N, width, hight)\n\t\t\tconst gpuCircle = circleInfosToGPUCircle(circleInfos)\n\t\t\trunner.setCircles(gpuCircle)\n\t\t\tconst lightInfo = runner.run()\n\t\t\tconsole.log(lightInfo, width, hight)\n\t\t\t/* @ts-ignore */\n\t\t\trender(gpuCircle, lightInfo, N)\n\t\t}\n\t}, [N])\n\n\treturn (\n\t\t<div id=\"GPUCircle\">\n\t\t</div>\n\t)\n}","import React from 'react';\nimport './App.css';\nimport GPUCircle from \"./page/light/GPUCircle\"\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <GPUCircle />\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}